<!DOCTYPE html>
<html lang="{{ lang }}">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ _("Forum") }}</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
    <style>
      html { font-family: "Inter", system-ui; }
      @media (prefers-color-scheme: light) {
          html {
              background-color: #FFFFFD;
              color: #444;
          }
      }
      @media (prefers-color-scheme: dark) {
          html {
              background-color: #222;
              color: #AAA;
          }
      }

      body {
          max-width: 800px;
          margin: auto;
      }
      @media (max-width: 800px) {
          body {
              width: auto;
              margin: 10px;
          }
      }

      @media (prefers-color-scheme: light) { .error { color: #A11; } }
      @media (prefers-color-scheme: dark) { .error { color: #E66; } }

      #language-selector {
          display: block;
          position: absolute;
          right: 10px;
          top: 10px;
          padding: 5px;
      }

      #skip-nav-link {
          display: block;
          position: absolute;
          top: 0px;
          left: 0px;
          width: 100%;
          text-align: center;
      }
      #skip-nav-link:not(:focus) { opacity: 0; }

      #content {
          margin-top: 30px;
          margin-bottom: 30px;
      }

      .inline-form {
          display: inline-block;
      }

      /* A class for elements (mostly brs) which improve usability
       * for browsers that do not support CSS at all. */
      .for-no-css { display: none; }
    </style>
    {% block head %}{% endblock %}
  </head>
  <body>
    <a id="skip-nav-link" href="#content">Skip to content</a>
    <!-- TODO(accessibility): ARIA labels -->
    <form id="language-selector" action="/change_language" method="POST">
      <!-- TODO(security): CSRF protection -->
      <select name="new_language">
        {% for language in languages %}
        <option {% if language == current_language %}selected{% endif %}>{{ language }}</option>
        {% endfor %}
      </select>
      <input type="hidden" name="redirect_url" value="{{ current_path }}">
      <button type="submit">{{ _("Change language") }}</button>
    </form>

    <header>
      <a href="/"><h1>{{ _("Forum") }}</h1></a>
    </header>

    {% if logged_in_user is not none %}
    <aside id="logout-form">
      {{ _("Logged in as %(username)s.", username=logged_in_user) }}
      <form class="inline-form" action="/logout" method="POST">
        <!-- TODO(security): CSRF protection -->
        <input type="hidden" name="redirect_url" value="{{ current_path }}">
        <button type="submit">{{ _("Logout") }}</button>
      </form>
    </aside>
    {% endif %}

    <main id="content">
      {% block content %}{% endblock %}
    </main>

    <footer>
      {{ _("Powered by tsoha-forum, a forum server written for the database course at the University of Helsinki, distributed under the GNU AGPLv3 license.") }}
      <a href="https://github.com/pcjens/tsoha-forum">GitHub/tsoha-forum</a>
    </footer>
  </body>
</html>
